
<html>
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Singapore Map</title>
<link rel="apple-touch-icon" href="touch-icon-iphone.png">
<link rel="manifest" href="manifest.json" />
<meta name="theme-color" content="#d8e8c8" />
<!-- <script>
	if (window.location.protocol === "http:"
			&& window.location.origin != "localhost") {
		location.href = location.href.replace("http://", "https://");
	}
	console.log(Notification.permission)
</script>
 -->

<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<meta name="msapplication-TileImage" content="images/icons/icon-152x152">
<meta name="msapplication-TileColor" content="#ffffff">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.css" />
<script src="https://cdn.onemap.sg/leaflet/onemap-leaflet.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

</head>
<body>
	<noscript>You need to enable JavaScript to run this app.</noscript>
	<p style="float:left;"><a href="/homepage.html">Car Parks</a></p>
	<div id='mapdiv' style='height: 100%;'></div>
	
	 <script>
        var center = L.bounds([1.56073, 104.11475], [1.16, 103.502]).getCenter();
        var map = L.map('mapdiv').setView([center.x, center.y], 12);

        var basemap = L.tileLayer('https://maps-{s}.onemap.sg/v3/Default/{z}/{x}/{y}.png', {
          detectRetina: true,
          maxZoom: 18,
          minZoom: 11
        });

        map.setMaxBounds([[1.56073, 104.1147], [1.16, 103.502]]);

        basemap.addTo(map);

        function getLocation() {
          if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(showPosition);
          } 
        }

        function showPosition(position) {           
          marker = new L.Marker([position.coords.latitude, position.coords.longitude], {bounceOnAdd: false}).addTo(map);             
          var popup = L.popup()
          .setLatLng([position.coords.latitude, position.coords.longitude]) 
          .setContent('You are here!')
          .openOn(map);         
        }
      </script>

	<script type="text/javascript">
		if ('serviceWorker' in navigator) {
			navigator.serviceWorker.register('/sw.js').then(function() {
				console.log("Service Worker Registered");
			});
		}
		
		$("#carParks").click(function(){
		  alert("iframe gov.div");
		}); 

		$("#oneMapDiv").click(function(){
		  alert("Onemap div.");
		}); 
	</script>
	<script type="text/javascript">
		var data = {
			  resource_id: '139a3035-e624-4f56-b63f-89ae28d4ae4c', // the resource id
			  limit: 5, // get 5 results
			  q: 'jones' // query for 'jones'
		};
		$.ajax({
		  url: 'https://data.gov.sg/api/action/datastore_search',
		  data: data,
		  dataType: 'jsonp',
		  success: function(data) {
		    alert('Total results found: ' + data.result.total)
		  }
		});
	
	</script>
</body>
</html>